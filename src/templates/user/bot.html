{% load i18n %}

{% extends "base_generic.html" %}

{% block title %}Bocchi{% endblock %}

{% block css %}{% endblock %}

{% block javascript %}
<script type="text/javascript">
$(function() {
	$('#save').click(function(){
		//$('form').submit();
		var postData = {};
        $('form').find('select').each(function(){
            postData[$(this).attr('name')] = $(this).val();
        });
        $('form').find('input').each(function(){
            postData[$(this).attr('name')] = $(this).val();
        });
        
        $.post('/api/update/bot', postData, function(data){
        	if (data.status) {
        		alert('Saved');
        	}
        }, 'JSON');
 
        return false;
	});
	
	$('form').submit(function(){
		return false;
	});
});
function clickclear(thisfield, defaulttext) {
	if (thisfield.value == defaulttext) {
		thisfield.value = "";
	}
}
function clickrecall(thisfield, defaulttext) {
	if (thisfield.value == "") {
		thisfield.value = defaulttext;
	}
}
</script>
{% endblock %}

{% block content %}
<h1>Bot</h1>
<ul class="field">
	<li><h3>Bot ID</h3>{{ user_prefs.bot_prefs_key.bot_id }}</li>
	<li><h3>Nickname</h3>{{ user_prefs.bot_prefs_key.nickname }}</li>
</ul>

<hr />

<h1>Choose Bot ID</h1>
<form action="/user/bot" method="post">
	<input type="hidden" name="key" value="{{ key }}" />
	<ul class="field">
		<li><select name="bot_id">
		<option value="_custom">Custom</option>
		{% for row in bot_list %}
		<option value="{{ row.bot_id }}" {% ifequal row.bot_id user_prefs.bot_prefs_key.bot_id %}selected="selected"{% endifequal %}>{{ row.nickname }}</option>
		{% endfor %}
	</select></li>
	<li><input type="text" name="custom_bot_id" value="Custom ID" onclick="clickclear(this, 'Custom ID')" onblur="clickrecall(this,'Custom ID')" /></li>
	</ul>
	<p><a href="#" id="save" class="button white">Save</a></p>
</form>
{% endblock %}